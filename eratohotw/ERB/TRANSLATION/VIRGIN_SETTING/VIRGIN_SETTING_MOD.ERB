@VIRGIN_SET_MOD
PRINTL Here some various settings for characters can be set before the game starts.
DRAWLINE
PRINTL [0] Finished
PRINTL [1] Choose Settings Individually
PRINTL [2] Everyone Is A Virgin
PRINTL [3] Due To Their Long Lives, The Girls Should All Have Some Experience
PRINTL [4] Everyone Is A Slut
PRINTL [5] Everyone Is A Loli
PRINTL [6] Everyone Is An Inchling With Animal Ears
PRINTL [7] Everyone Is A Futanari
PRINTL [8] Everyone Is A Slut Virgin
PRINTL [9] Everyone Is Clueless
PRINTL [10] Go to random options menu
PRINTL [11] Everyone Is Reset To Default
$LOOP
INPUT
SELECTCASE RESULT
	CASE 0
		PRINTW Configuration set.
		RETURN
	CASE 1
		CALL SET_VIRGINITY_MOD
	CASE 2
		FOR LOCAL,1,CHARANUM
			CALL SET_VIRGIN(LOCAL)
		NEXT
		PRINTW What a virgin-fag!
		PRINTW Everyone is now a virgin with zero experience.
	CASE 3
		FOR LOCAL,1,CHARANUM
			TALENT:LOCAL:処女 = 0
			SIF TALENT:LOCAL:性別嗜好 == 1
				TALENT:LOCAL:性別嗜好 = 0
			EXP:LOCAL:Ｖ経験 = MAX(EXP:LOCAL:Ｖ経験, 50)
			ABL:LOCAL:Ｖ感覚 = MAX(ABL:LOCAL:Ｖ感覚, 2)
			ABL:LOCAL:腰 = MAX(ABL:LOCAL:腰, 2)
			EXP:LOCAL:Ｖ性交経験 = MAX(EXP:LOCAL:Ｖ経験, 50)
			EXP:LOCAL:Ｖ拡張経験 = MAX(EXP:LOCAL:Ｖ拡張経験, 3)
			EXP:LOCAL:精液経験 = MAX(EXP:LOCAL:精液経験, 10)
		NEXT
		PRINTW No one is a virgin, and they all have experience.
	CASE 4
		FOR LOCAL,1,CHARANUM
			CALL SET_YARIMAN(LOCAL)
		NEXT
		PRINTW Everyone is a slut with lots of experience.
	CASE 5
		FOR LOCAL,1,CHARANUM
			CALL SET_LOLI(LOCAL)
		NEXT
		IF TALENT:MASTER:形状 < 6
			PRINTFORML Lolicon is fine too!
			PRINTFORML
			PRINTW Everyone is now a loli.
		ELSE
			PRINTFORML You devil!
			PRINTFORML
			PRINTW Everyone is now a loli.
		ENDIF
	CASE 6
		FOR LOCAL,1,CHARANUM
			TALENT:LOCAL:体型 = -5
			TALENT:LOCAL:143 = 1
		NEXT
		IF TALENT:MASTER:形状 < 3
			PRINTW Everyone is now an inchling with animal ears.
		ELSE
			PRINTFORML You bastard!
			PRINTFORML 
			PRINTW Everyone is now an inchling with animal ears.
		ENDIF
	CASE 7
		FOR LOCAL,1,CHARANUM
			TALENT:LOCAL:2 = 3
			TALENT:LOCAL:形状 = 3
			MAXBASE:LOCAL:5 = 1500
			MAXBASE:LOCAL:精力 = 1000
		NEXT
		PRINTFORMW Everyone is now a futanari.
	CASE 8
		PRINTFORMW Don't go causing trouble.
		FOR LOCAL,1,CHARANUM
			TALENT:LOCAL:処女 = 1
			SIF TALENT:LOCAL:性別嗜好 == 1
				TALENT:LOCAL:性別嗜好 = 0
			EXP:LOCAL:Ｖ経験 = 0
			ABL:LOCAL:Ｖ感覚 = 0
			ABL:LOCAL:欲望 = 3
			EXP:LOCAL:Ｖ性交経験 = 0
			EXP:LOCAL:Ｖ拡張経験 = 0
			EXP:LOCAL:精液経験 = 0
			TALENT:LOCAL:ヤリマン = 1
			TALENT:LOCAL:貞操 = -1
		NEXT
		PRINTW Everyone is now a slut virgin.
	CASE 9
		FOR LOCAL,1,CHARANUM
			CALL SET_VIRGIN(LOCAL)
			TALENT:LOCAL:無知 = 1
		NEXT
		PRINTW What a Kotohime.
		PRINTW Everyone is an ignorant virgin.
	CASE 10
		CALL CCREATE_RANDOMIZE()
	CASE 11
		FOR LOCAL,1,CHARANUM
			CALL RESET_CHARA(LOCAL)
		NEXT
		PRINTFORMW Everyone was return to default settings.
	CASEELSE
		GOTO LOOP
ENDSELECT
RESTART

@SET_VIRGINITY_MOD(ARG)
#DIM CHARA_ID
#DIM FIRST_LINE
#DIM OTHER_LINE
#DIM CREDRAW
#DIM DONE
#DIM KNOWLEDGE, 200
DONE = 0

FIRST_LINE = LINECOUNT
CREDRAW = CURRENTREDRAW()
$RESETLOOP
REDRAW 0
FOR CHARA_ID, 1, CHARANUM -1
	IF TALENT:CHARA_ID:処女
		SETCOLOR C_PINK
	ELSEIF TALENT:CHARA_ID:ヤリマン
		SETCOLOR C_P_BLUE
	ENDIF
	PRINTFORMLC [{CHARA_ID, 3}] %CALLNAME:CHARA_ID%
	RESETCOLOR
NEXT
PRINTL 　
DRAWLINE
PRINTL [998] Reset everyone
PRINTL [999] Done with settings
DO
	INPUT
	CHARA_ID = RESULT
	SELECTCASE CHARA_ID
	CASE 998
		FOR LOCAL,1,CHARANUM -1
			CALL RESET_CHARA(LOCAL)
		NEXT
		PRINTW All characters have been reset to default.
		CLEARLINE 2
	CASE 999
		PRINTW The current settings have been saved.
		RETURN
	CASE 1 TO CHARANUM -2
		BREAK
	CASEELSE
	ENDSELECT
LOOP 1

$LOOP
OTHER_LINE = LINECOUNT
PRINTFORML [1000] Virgin - \@TALENT:CHARA_ID:処女 == 1 ?yes#no\@
PRINTFORM [1001] Experience - 
SELECTCASE KNOWLEDGE:CHARA_ID
	CASE 0
		PRINTFORML Default
	CASE 1
		PRINTFORML Clueless
	CASE 2
		PRINTFORML Knowledgeable
	CASE 3
		PRINTFORML Slut
ENDSELECT
PRINTFORML [1002] Futanari - \@TALENT:CHARA_ID:性別 == 1 ?no#yes\@
PRINTFORM [1003] Stature - 
SELECTCASE TALENT:CHARA_ID:体型
	CASE 0
		PRINTFORML Normal \@CSVTALENT(CHARA_ID, GETNUM(TALENT, "体型")) == 0?(default)#\@
CASEELSE
	PRINTFORML %GET_TALENTNAME_TR(100, TALENT:CHARA_ID:体型)% \@CSVTALENT(CHARA_ID, GETNUM(TALENT, "体型")) == TALENT:CHARA_ID:体型?(default)#\@
ENDSELECT
PRINTFORML [1004] Apply these settings to everyone
PRINTFORML [1005] Apply these settings to everyone (skip stature)
PRINTFORML [1006] Reset this character 
PRINTFORML [1007] Done with this character
INPUT
SELECTCASE RESULT
	CASE 1000
		TALENT:CHARA_ID:処女 = !TALENT:CHARA_ID:処女
	CASE 1001
		SELECTCASE KNOWLEDGE:CHARA_ID
			CASE 0
				EXP:CHARA_ID:Ｃ経験 = 0
				EXP:CHARA_ID:Ｂ経験 = 0
				EXP:CHARA_ID:Ｖ経験 = 0
				EXP:CHARA_ID:Ａ経験 = 0
				ABL:CHARA_ID:Ｖ感覚 = 0
				ABL:CHARA_ID:Ａ感覚 = 0
				EXP:CHARA_ID:Ｖ性交経験 = 0
				EXP:CHARA_ID:Ｖ拡張経験 = 0
				EXP:CHARA_ID:Ａ性交経験 = 0
				EXP:CHARA_ID:Ａ拡張経験 = 0
				EXP:CHARA_ID:手淫経験 = 0
				EXP:CHARA_ID:口淫経験 = 0
				EXP:CHARA_ID:パイズリ経験 = 0
				EXP:CHARA_ID:キス経験 = 0
				EXP:CHARA_ID:奉仕快楽経験 = 0
				EXP:CHARA_ID:愛情経験 = 0
				EXP:CHARA_ID:苦痛快楽経験 = 0
				EXP:CHARA_ID:嗜虐快楽経験 = 0
				EXP:CHARA_ID:露出快楽経験 = 0
				EXP:CHARA_ID:緊縛経験 = 0
				EXP:CHARA_ID:絶頂経験 = 0
				EXP:CHARA_ID:射精経験 = 0
				EXP:CHARA_ID:噴乳経験 = 0
				EXP:CHARA_ID:放尿経験 = 0
				EXP:CHARA_ID:精液経験 = 0
				EXP:CHARA_ID:精飲経験 = 0
				EXP:CHARA_ID:出産経験 = 0
				TALENT:CHARA_ID:ヤリマン = 0
				TALENT:CHARA_ID:無知 = 1
			CASE 1
				CALL RESET_PARTS(CHARA_ID)
				EXP:CHARA_ID:Ｖ経験 = MAX(EXP:CHARA_ID:Ｖ経験, 50)
				ABL:CHARA_ID:Ｖ感覚 = MAX(ABL:CHARA_ID:Ｖ感覚, 2)
				ABL:CHARA_ID:腰 = MAX(ABL:CHARA_ID:腰, 2)
				EXP:CHARA_ID:Ｖ性交経験 = MAX(EXP:CHARA_ID:Ｖ経験, 50)
				EXP:CHARA_ID:Ｖ拡張経験 = MAX(EXP:CHARA_ID:Ｖ拡張経験, 3)
				EXP:CHARA_ID:精液経験 = MAX(EXP:CHARA_ID:精液経験, 10)
			CASE 2
				CALL RESET_PARTS(CHARA_ID)
				SIF TALENT:CHARA_ID:性別嗜好 == 1
					TALENT:CHARA_ID:性別嗜好 = 0
				EXP:CHARA_ID:Ｖ経験 = MAX(EXP:CHARA_ID:Ｖ経験, 100)
				ABL:CHARA_ID:Ｖ感覚 = MAX(ABL:CHARA_ID:Ｖ感覚, 3)
				ABL:CHARA_ID:腰 = MAX(ABL:CHARA_ID:腰, 3)
				ABL:CHARA_ID:欲望 = 3
				EXP:CHARA_ID:Ｖ性交経験 = MAX(EXP:CHARA_ID:Ｖ経験, 100)
				EXP:CHARA_ID:Ｖ拡張経験 = MAX(EXP:CHARA_ID:Ｖ拡張経験, 3)
				EXP:CHARA_ID:精液経験 = MAX(EXP:CHARA_ID:精液経験, 50)
				TALENT:CHARA_ID:ヤリマン = 1
				TALENT:CHARA_ID:貞操 = -1
			CASE 3
				CALL RESET_PARTS(CHARA_ID)
		ENDSELECT
		KNOWLEDGE:CHARA_ID++
		KNOWLEDGE:CHARA_ID%=4
	CASE 1002
		IF TALENT:CHARA_ID:性別 == 3
			TALENT:CHARA_ID:性別 = 1
		ELSE
			TALENT:CHARA_ID:性別 = 3
			TALENT:CHARA_ID:形状 = 3
			MAXBASE:CHARA_ID:5 = 1500
			MAXBASE:CHARA_ID:精力 = 1000
		ENDIF
	CASE 1003
		SELECTCASE TALENT:CHARA_ID:体型
			CASE -5
				TALENT:CHARA_ID:体型 = -2
			CASE -2
				TALENT:CHARA_ID:体型 = -1
			CASE -1
				TALENT:CHARA_ID:体型 = 0
			CASE 0
				TALENT:CHARA_ID:体型 = 1
			CASE 1
				TALENT:CHARA_ID:体型 = 2
			CASE 2
				TALENT:CHARA_ID:体型 = 5
			CASE 5
				TALENT:CHARA_ID:体型 = -5
		ENDSELECT
	CASE 1004, 1005
		FOR LOCAL,1,CHARANUM
			TALENT:LOCAL:処女 = TALENT:CHARA_ID:処女
			IF TALENT:CHARA_ID:性別 == 1
				TALENT:LOCAL:性別 = 1
				TALENT:LOCAL:形状 = 0
			ELSE
				TALENT:LOCAL:性別 = 3
				TALENT:LOCAL:形状 = 3
				MAXBASE:LOCAL:5 = 1500
				MAXBASE:LOCAL:精力 = 1000
			ENDIF
			
			SIF RESULT == 1004
				TALENT:LOCAL:体型 = TALENT:CHARA_ID:体型
			SELECTCASE KNOWLEDGE:CHARA_ID
				CASE 0
					CALL RESET_PARTS(CHARA_ID)
				CASE 1
					EXP:LOCAL:Ｃ経験 = 0
					EXP:LOCAL:Ｂ経験 = 0
					EXP:LOCAL:Ｖ経験 = 0
					EXP:LOCAL:Ａ経験 = 0
					ABL:LOCAL:Ｖ感覚 = 0
					ABL:LOCAL:Ａ感覚 = 0
					EXP:LOCAL:Ｖ性交経験 = 0
					EXP:LOCAL:Ｖ拡張経験 = 0
					EXP:LOCAL:Ａ性交経験 = 0
					EXP:LOCAL:Ａ拡張経験 = 0
					EXP:LOCAL:手淫経験 = 0
					EXP:LOCAL:口淫経験 = 0
					EXP:LOCAL:パイズリ経験 = 0
					EXP:LOCAL:キス経験 = 0
					EXP:LOCAL:奉仕快楽経験 = 0
					EXP:LOCAL:愛情経験 = 0
					EXP:LOCAL:苦痛快楽経験 = 0
					EXP:LOCAL:嗜虐快楽経験 = 0
					EXP:LOCAL:露出快楽経験 = 0
					EXP:LOCAL:緊縛経験 = 0
					EXP:LOCAL:絶頂経験 = 0
					EXP:LOCAL:射精経験 = 0
					EXP:LOCAL:噴乳経験 = 0
					EXP:LOCAL:放尿経験 = 0
					EXP:LOCAL:精液経験 = 0
					EXP:LOCAL:精飲経験 = 0
					EXP:LOCAL:出産経験 = 0
					TALENT:LOCAL:ヤリマン = 0
					TALENT:LOCAL:無知 = 1
				CASE 2
					CALL RESET_PARTS(LOCAL)
					EXP:LOCAL:Ｖ経験 = MAX(EXP:LOCAL:Ｖ経験, 50)
					ABL:LOCAL:Ｖ感覚 = MAX(ABL:LOCAL:Ｖ感覚, 2)
					ABL:LOCAL:腰 = MAX(ABL:LOCAL:腰, 2)
					EXP:LOCAL:Ｖ性交経験 = MAX(EXP:LOCAL:Ｖ経験, 50)
					EXP:LOCAL:Ｖ拡張経験 = MAX(EXP:LOCAL:Ｖ拡張経験, 3)
					EXP:LOCAL:精液経験 = MAX(EXP:LOCAL:精液経験, 10)
				CASE 3
					CALL RESET_PARTS(LOCAL)
					SIF TALENT:LOCAL:性別嗜好 == 1
						TALENT:LOCAL:性別嗜好 = 0
					EXP:LOCAL:Ｖ経験 = MAX(EXP:LOCAL:Ｖ経験, 100)
					ABL:LOCAL:Ｖ感覚 = MAX(ABL:LOCAL:Ｖ感覚, 3)
					ABL:LOCAL:腰 = MAX(ABL:LOCAL:腰, 3)
					ABL:LOCAL:欲望 = 3
					EXP:LOCAL:Ｖ性交経験 = MAX(EXP:LOCAL:Ｖ経験, 100)
					EXP:LOCAL:Ｖ拡張経験 = MAX(EXP:LOCAL:Ｖ拡張経験, 3)
					EXP:LOCAL:精液経験 = MAX(EXP:LOCAL:精液経験, 50)
					TALENT:LOCAL:ヤリマン = 1
					TALENT:LOCAL:貞操 = -1
			ENDSELECT
		NEXT
		PRINTFORMW Settings have been applied to everyone.
	CASE 1006
		CALL RESET_CHARA(CHARA_ID)
		KNOWLEDGE:CHARA_ID = 0
	CASE 1007
		DONE = 1
ENDSELECT
IF !DONE
	CLEARLINE LINECOUNT - OTHER_LINE
	GOTO LOOP
ENDIF
DONE = 0
CLEARLINE LINECOUNT - FIRST_LINE
REDRAW CREDRAW
GOTO RESETLOOP


;lets you pick like "50% futa"
@CCREATE_RANDOMIZE
#DIM CREDRAW
#DIM FIRST_LINE
#DIM CHARA_ID
#DIMS SAVE_NAME
#DIM INCLUDE_EXCLUSIONS
#DIMS TALENT_SETS, 50 = "Gender", "Virgin", "Non-Virgin", "Clueless", "Knowledgable", "Slut","Inchling","Fairy","Loli","Normal","Tall","Flat Breasts","Small Breasts","Normal Breasts","Big Breasts","Huge Breasts","Childlike","Keep Default Ears","No Ears","Animal Ears","Rabbit Ears","Dog Ears","Cat Ears"
#DIM PERC_SETS, 50, 3
#DIM IDENTIFIER, 150, 2 ;3 times the size of PERC_SETS
#DIM CURRENT_TALENT
#DIM CURRENT_GENDER
#DIM CHOOSE_BY_GENDER
#DIM SAVE_SLOT
FIRST_LINE = LINECOUNT
$REPRINT
CLEARLINE LINECOUNT - FIRST_LINE
CREDRAW = CURRENTREDRAW()
REDRAW 0

DRAWLINE
PRINTL Select a percentage to adjust each category. Percentages are split between sections.
PRINTL Unless 'Choose By Gender' is enabled, rows will all change at the same time. Gender is excluded.
PRINTL The above setting can only be disabled by resetting or loading a setting where it wasnt enabled.
PRINTL If both Virgin and Non-Virgin are set to 0%, characters start with default virginity.
PRINTL Same with knowledge and height. (Normal height does not mean default)
PRINTL
PRINTFORM %"",20,LEFT%%"Female",7,LEFT%%" |  Trap ",8,LEFT%%" |  Futa ",8,LEFT%
PRINTL
FOR LOCAL, 0, 23
	PRINTFORM %TALENT_SETS:LOCAL,20,LEFT%
	IDENTIFIER:(LOCAL * 3):0 = LOCAL
	IDENTIFIER:(LOCAL * 3):1 = 0
	IDENTIFIER:((LOCAL * 3)+ 1):0 = LOCAL
	IDENTIFIER:((LOCAL * 3)+ 1):1 = 1
	IDENTIFIER:((LOCAL * 3)+ 2):0 = LOCAL
	IDENTIFIER:((LOCAL * 3)+ 2):1 = 2
	IF LOCAL == 17
		PRINTBUTTON @" %\@PERC_SETS:LOCAL:0 == 1? ON # OFF\@, 7, LEFT%", (LOCAL * 3)
		PRINTBUTTON @"|  %\@PERC_SETS:LOCAL:1 == 1? ON # OFF\@, 5, LEFT% ", ((LOCAL * 3) + 1)
		PRINTBUTTON @"|  %\@PERC_SETS:LOCAL:2 == 1? ON # OFF\@, 6, LEFT% ", ((LOCAL * 3) + 2)
	ELSE
		PRINTBUTTON @" %@"{PERC_SETS:LOCAL:0}％", 7, LEFT%", (LOCAL * 3)
		PRINTBUTTON @"%@"|  {PERC_SETS:LOCAL:1}％", 8, LEFT% ", ((LOCAL * 3) + 1)
		PRINTBUTTON @"%@"|  {PERC_SETS:LOCAL:2}％", 8, LEFT% ", ((LOCAL * 3) + 2)
	ENDIF
	;Add {LOCAL} to next line for debugging, number displayed is the TALENT_SETS:LOCAL and PERC_SETS:LOCAL equilivant
	PRINTFORML
	SIF LOCAL == 0 || LOCAL == 2 || LOCAL == 5 || LOCAL == 10 || LOCAL == 15 || LOCAL == 16
	PRINTL ---------------------------------------------
NEXT
PRINTL
SIF CHOOSE_BY_GENDER == 0
PRINTC [994] - Choose By Gender　　
PRINTLC [995] - Reset Current
PRINTL [996] - Exclude characters
PRINTLC [997] - Save Settings
PRINTLC [998] - Load Settings
PRINTL [999] - Apply Current Settings
PRINTL
PRINTL [1000] - Return

$INPUT_LOOP
INPUT
SELECTCASE RESULT
	CASE 51 TO 53 ;Keep Default Ears
		CURRENT_TALENT = IDENTIFIER:RESULT:0
		CURRENT_GENDER = IDENTIFIER:RESULT:1
		IF PERC_SETS:CURRENT_TALENT:CURRENT_GENDER == 1
			PERC_SETS:CURRENT_TALENT:CURRENT_GENDER = 0
			PRINTW Disabled default, random ears will apply to all characters
		ELSE
			PERC_SETS:CURRENT_TALENT:CURRENT_GENDER = 1
			PRINTW Enabled default, if a character already has ears they won't get replaced
		ENDIF
	CASE 0 TO 150
		CURRENT_TALENT = IDENTIFIER:RESULT:0
		CURRENT_GENDER = IDENTIFIER:RESULT:1

		;Set the limit for the talent sets
		IF INRANGE(RESULT, 0, 2) ; Gender
			LOCAL = 100-PERC_SETS:0:0-PERC_SETS:0:1-PERC_SETS:0:2+PERC_SETS:0:CURRENT_GENDER
		ELSEIF INRANGE(RESULT, 3, 8) ;Virgin
			LOCAL = 100-PERC_SETS:1:CURRENT_GENDER-PERC_SETS:2:CURRENT_GENDER+PERC_SETS:CURRENT_TALENT:CURRENT_GENDER
		ELSEIF INRANGE(RESULT, 9, 17) ;Clueless to slut
			LOCAL = 100-PERC_SETS:3:CURRENT_GENDER-PERC_SETS:4:CURRENT_GENDER-PERC_SETS:5:CURRENT_GENDER+PERC_SETS:CURRENT_TALENT:CURRENT_GENDER+PERC_SETS:CURRENT_TALENT:CURRENT_GENDER
		ELSEIF INRANGE(RESULT, 18, 32) ;Height
			LOCAL = 100-PERC_SETS:6:CURRENT_GENDER-PERC_SETS:7:CURRENT_GENDER-PERC_SETS:8:CURRENT_GENDER-PERC_SETS:9:CURRENT_GENDER-PERC_SETS:10:CURRENT_GENDER+PERC_SETS:CURRENT_TALENT:CURRENT_GENDER
		ELSEIF INRANGE(RESULT, 33, 47) ;Breasts
			LOCAL = 100-PERC_SETS:11:CURRENT_GENDER-PERC_SETS:12:CURRENT_GENDER-PERC_SETS:13:CURRENT_GENDER-PERC_SETS:14:CURRENT_GENDER-PERC_SETS:15:CURRENT_GENDER+PERC_SETS:CURRENT_TALENT:CURRENT_GENDER
		ELSEIF INRANGE(RESULT, 54, 65) ;Animal Ears
			LOCAL = 100-PERC_SETS:18:CURRENT_GENDER-PERC_SETS:19:CURRENT_GENDER-PERC_SETS:20:CURRENT_GENDER-PERC_SETS:21:CURRENT_GENDER+PERC_SETS:CURRENT_TALENT:CURRENT_GENDER
		ELSE ;Childlike
			LOCAL = 100
		ENDIF
		;Get and Set user input
		IF LOCAL > 0
			PRINTFORML Insert percentage between 0 and {LOCAL}:
			INPUT
			IF !INRANGE(RESULT, 0, LOCAL)
				PRINTW Invalid input
				GOTO REPRINT
			ELSE
				IF CURRENT_TALENT == 0 || CHOOSE_BY_GENDER == 1
					PERC_SETS:CURRENT_TALENT:CURRENT_GENDER = RESULT
				ELSE
					PERC_SETS:CURRENT_TALENT:0 = RESULT
					PERC_SETS:CURRENT_TALENT:1 = RESULT
					PERC_SETS:CURRENT_TALENT:2 = RESULT
				ENDIF
			ENDIF
		ELSE
			PRINTW Cannot increase due to related talents being at 100%.
		ENDIF
	CASE 994
		PRINTL Are you sure, this can only be disabled by resetting or loading a save where this hasnt been done?
		CALL ASK_YN()
			IF RESULT == 0
				CHOOSE_BY_GENDER = 1
			ENDIF
	CASE 995
		PRINTL Are you sure you want to reset everything?
		CALL ASK_YN()
		IF RESULT == 0
			CHOOSE_BY_GENDER = 0
			FOR LOCAL, 0, 23
				PERC_SETS:LOCAL:0 = 0
				PERC_SETS:LOCAL:1 = 0
				PERC_SETS:LOCAL:2 = 0
			NEXT
		ENDIF
	CASE 996
		CALL EXCLUDE_CHARACTERS()
	CASE 997
		LOADGLOBAL
		PRINTL Save Settings
		PRINTFORML [0] Slot 0 \@STRLENS(RANDOM_SAVE_MENU_NAMES:0) > 0 ? - %RANDOM_SAVE_MENU_NAMES:0% # \@
		PRINTFORML [1] Slot 1 \@STRLENS(RANDOM_SAVE_MENU_NAMES:1) > 0 ? - %RANDOM_SAVE_MENU_NAMES:1% # \@
		PRINTFORML [2] Slot 2 \@STRLENS(RANDOM_SAVE_MENU_NAMES:2) > 0 ? - %RANDOM_SAVE_MENU_NAMES:2% # \@
		INPUT
		IF !INRANGE(RESULT, 0, 2)
			PRINTW Please keep within specified options.
			GOTO REPRINT
		ENDIF
		LOCAL = RESULT
		PRINTFORML Please name slot {LOCAL}, leave blank to cancel.
		INPUTS
		IF STRLENS(RESULTS) == 0
			GOTO REPRINT
		ELSE
			SAVE_NAME = %RESULTS%
			PRINTL Include exclusions
			CALL ASK_YN()
			IF RESULT == 0
				INCLUDE_EXCLUSIONS = 1
			ELSE
				INCLUDE_EXCLUSIONS = 0
			ENDIF
		ENDIF
		IF INRANGE(LOCAL, 0, 2)
			SAVE_SLOT = LOCAL
			LOADGLOBAL
			FOR LOCAL, 0, 23
				RANDOM_MENU_PERC:SAVE_SLOT:LOCAL:0 = PERC_SETS:LOCAL:0
				RANDOM_MENU_PERC:SAVE_SLOT:LOCAL:1 = PERC_SETS:LOCAL:1
				RANDOM_MENU_PERC:SAVE_SLOT:LOCAL:2 = PERC_SETS:LOCAL:2
			NEXT
			RANDOM_MENU_CHOOSE_BY_GENDER:SAVE_SLOT = CHOOSE_BY_GENDER
			RANDOM_SAVE_MENU_NAMES:SAVE_SLOT = %SAVE_NAME%
			SAVEGLOBAL
			PRINTFORML Saved slot {SAVE_SLOT} settings
			IF INCLUDE_EXCLUSIONS == 1
				CALL SAVE_EXCLUDE_CHARACTERS(SAVE_NAME, SAVE_SLOT)
				PRINTW Exclusions included with save
			ELSE
				PRINTW Exclusions not included in save
			ENDIF
		ENDIF
	CASE 998
		LOADGLOBAL
		PRINTL Load Settings
		PRINTFORML [0] Slot 0 \@STRLENS(RANDOM_SAVE_MENU_NAMES:0) > 0 ? - %RANDOM_SAVE_MENU_NAMES:0% # \@
		PRINTFORML [1] Slot 1 \@STRLENS(RANDOM_SAVE_MENU_NAMES:1) > 0 ? - %RANDOM_SAVE_MENU_NAMES:1% # \@
		PRINTFORML [2] Slot 2 \@STRLENS(RANDOM_SAVE_MENU_NAMES:2) > 0 ? - %RANDOM_SAVE_MENU_NAMES:2% # \@
		INPUT
		LOCAL = RESULT
		PRINTFORML Load slot {LOCAL}?
		PRINTFORML [0] Yes
		PRINTFORML [1] Yes, include exclusions
		PRINTFORML [2] No
		INPUT
		IF RESULT == 0
			INCLUDE_EXCLUSIONS = 0
		ELSEIF RESULT == 1
			INCLUDE_EXCLUSIONS = 1
		ELSE
			GOTO REPRINT
		ENDIF
		IF INRANGE(LOCAL, 0, 3)
			SAVE_SLOT = LOCAL
			LOADGLOBAL
			FOR LOCAL, 0, 23
				PERC_SETS:LOCAL:0 = RANDOM_MENU_PERC:SAVE_SLOT:LOCAL:0
				PERC_SETS:LOCAL:1 = RANDOM_MENU_PERC:SAVE_SLOT:LOCAL:1
				PERC_SETS:LOCAL:2 = RANDOM_MENU_PERC:SAVE_SLOT:LOCAL:2
			NEXT
			CHOOSE_BY_GENDER = RANDOM_MENU_CHOOSE_BY_GENDER:SAVE_SLOT
			PRINTFORMW Loaded settings from slot {SAVE_SLOT}
			IF INCLUDE_EXCLUSIONS == 1
				CALL LOAD_EXCLUDE_CHARACTERS(SAVE_SLOT)
			ELSE
				PRINTW Exclusions not loaded
			ENDIF
		ENDIF
	CASE 999
		LOCAL:3 = 0
		FOR CHARA_ID, 1, CHARANUM-1
			SIF CFLAG:CHARA_ID:RANDOM_MENU_EXCLUSION
				CONTINUE
			LOCAL:3 += 1
			;GENDER
			LOCAL = RAND:100+1
			IF LOCAL <= PERC_SETS:0:2
				TALENT:CHARA_ID:2 = 3
				TALENT:CHARA_ID:形状 = 3
				MAXBASE:CHARA_ID:5 = 1500
				MAXBASE:CHARA_ID:精力 = 1000
			ELSEIF LOCAL <= PERC_SETS:0:2+PERC_SETS:0:1
				TALENT:CHARA_ID:2 = 2
				TALENT:CHARA_ID:形状 =  RAND:6 + 1
				MAXBASE:CHARA_ID:5 = 1500
				MAXBASE:CHARA_ID:精力 = 1000
				TALENT:CHARA_ID:処女 = 0
			ELSE
				TALENT:CHARA_ID:2 = CSVTALENT(CHARA_ID,2)
				TALENT:CHARA_ID:形状 = CSVTALENT(CHARA_ID,250)
			ENDIF
			CURRENT_GENDER = (TALENT:CHARA_ID:2 - 1)
			;VIRGIN NON_VIRGIN
			LOCAL = RAND:100+1
			IF LOCAL <= PERC_SETS:1:CURRENT_GENDER
				IF CURRENT_GENDER == 0
					TALENT:CHARA_ID:処女 = 1
				ELSEIF CURRENT_GENDER == 1
					TALENT:CHARA_ID:1 = 0
				ELSEIF CURRENT_GENDER == 2
					TALENT:CHARA_ID:処女 = 1
					TALENT:CHARA_ID:1 = 0
				ENDIF
			ELSEIF LOCAL <= PERC_SETS:1:CURRENT_GENDER+PERC_SETS:2:CURRENT_GENDER
				TALENT:CHARA_ID:処女 = 0
				TALENT:CHARA_ID:1 = 1
			ELSE
				TALENT:CHARA_ID:処女 = CSVTALENT(CHARA_ID,0)
				TALENT:CHARA_ID:1 = CSVTALENT(CHARA_ID,1)
			ENDIF
			;CLUELESS KNOW SLUT
			LOCAL = RAND:100+1
			IF LOCAL <= PERC_SETS:3:CURRENT_GENDER
				EXP:CHARA_ID:Ｃ経験 = 0
				EXP:CHARA_ID:Ｂ経験 = 0
				EXP:CHARA_ID:Ｖ経験 = 0
				EXP:CHARA_ID:Ａ経験 = 0
				ABL:CHARA_ID:Ｖ感覚 = 0
				ABL:CHARA_ID:Ａ感覚 = 0
				EXP:CHARA_ID:Ｖ性交経験 = 0
				EXP:CHARA_ID:Ｖ拡張経験 = 0
				EXP:CHARA_ID:Ａ性交経験 = 0
				EXP:CHARA_ID:Ａ拡張経験 = 0
				EXP:CHARA_ID:手淫経験 = 0
				EXP:CHARA_ID:口淫経験 = 0
				EXP:CHARA_ID:パイズリ経験 = 0
				EXP:CHARA_ID:キス経験 = 0
				EXP:CHARA_ID:奉仕快楽経験 = 0
				EXP:CHARA_ID:愛情経験 = 0
				EXP:CHARA_ID:苦痛快楽経験 = 0
				EXP:CHARA_ID:嗜虐快楽経験 = 0
				EXP:CHARA_ID:露出快楽経験 = 0
				EXP:CHARA_ID:緊縛経験 = 0
				EXP:CHARA_ID:絶頂経験 = 0
				EXP:CHARA_ID:射精経験 = 0
				EXP:CHARA_ID:噴乳経験 = 0
				EXP:CHARA_ID:放尿経験 = 0
				EXP:CHARA_ID:精液経験 = 0
				EXP:CHARA_ID:精飲経験 = 0
				EXP:CHARA_ID:出産経験 = 0
				TALENT:CHARA_ID:ヤリマン = 0
				TALENT:CHARA_ID:無知 = 1
			ELSEIF LOCAL <= PERC_SETS:3:CURRENT_GENDER+PERC_SETS:4:CURRENT_GENDER
				CALL RESET_PARTS(CHARA_ID)
				EXP:CHARA_ID:Ｖ経験 = MAX(EXP:CHARA_ID:Ｖ経験, 50)
				ABL:CHARA_ID:Ｖ感覚 = MAX(ABL:CHARA_ID:Ｖ感覚, 2)
				ABL:CHARA_ID:腰 = MAX(ABL:CHARA_ID:腰, 2)
				EXP:CHARA_ID:Ｖ性交経験 = MAX(EXP:CHARA_ID:Ｖ経験, 50)
				EXP:CHARA_ID:Ｖ拡張経験 = MAX(EXP:CHARA_ID:Ｖ拡張経験, 3)
				EXP:CHARA_ID:精液経験 = MAX(EXP:CHARA_ID:精液経験, 10)
			ELSEIF LOCAL <= PERC_SETS:3:CURRENT_GENDER+PERC_SETS:4:CURRENT_GENDER+PERC_SETS:5:CURRENT_GENDER
				CALL RESET_PARTS(CHARA_ID)
				SIF TALENT:CHARA_ID:性別嗜好 == 1
					TALENT:CHARA_ID:性別嗜好 = 0
				EXP:CHARA_ID:Ｖ経験 = MAX(EXP:CHARA_ID:Ｖ経験, 100)
				ABL:CHARA_ID:Ｖ感覚 = MAX(ABL:CHARA_ID:Ｖ感覚, 3)
				ABL:CHARA_ID:腰 = MAX(ABL:CHARA_ID:腰, 3)
				ABL:CHARA_ID:欲望 = 3
				EXP:CHARA_ID:Ｖ性交経験 = MAX(EXP:CHARA_ID:Ｖ経験, 100)
				EXP:CHARA_ID:Ｖ拡張経験 = MAX(EXP:CHARA_ID:Ｖ拡張経験, 3)
				EXP:CHARA_ID:精液経験 = MAX(EXP:CHARA_ID:精液経験, 50)
				TALENT:CHARA_ID:ヤリマン = 1
				TALENT:CHARA_ID:貞操 = -1
			ELSE
				CALL RESET_PARTS(CHARA_ID)
			ENDIF
			;INCHLING FAIRY LOLI NORMAL TALL
			LOCAL = RAND:100+1
			IF LOCAL <= PERC_SETS:6:CURRENT_GENDER
				TALENT:CHARA_ID:体型 = -5
			ELSEIF LOCAL <= PERC_SETS:6:CURRENT_GENDER+PERC_SETS:7:CURRENT_GENDER
				TALENT:CHARA_ID:体型 = -2
			ELSEIF LOCAL <= PERC_SETS:6:CURRENT_GENDER+PERC_SETS:7:CURRENT_GENDER+PERC_SETS:8:CURRENT_GENDER
				TALENT:CHARA_ID:体型 = -1
			ELSEIF LOCAL <= PERC_SETS:6:CURRENT_GENDER+PERC_SETS:7:CURRENT_GENDER+PERC_SETS:8:CURRENT_GENDER+PERC_SETS:9:CURRENT_GENDER
				TALENT:CHARA_ID:体型 = 0
			ELSEIF LOCAL <= PERC_SETS:6:CURRENT_GENDER+PERC_SETS:7:CURRENT_GENDER+PERC_SETS:8:CURRENT_GENDER+PERC_SETS:9:CURRENT_GENDER+PERC_SETS:10:CURRENT_GENDER
				TALENT:CHARA_ID:体型 = 1
			ELSE
				TALENT:CHARA_ID:体型 = CSVTALENT(CHARA_ID,100)
			ENDIF
			;BREASTS_SIZES
			IF LOCAL <= PERC_SETS:11:CURRENT_GENDER
				TALENT:CHARA_ID:105 = -2
			ELSEIF LOCAL <= PERC_SETS:11:CURRENT_GENDER+PERC_SETS:12:CURRENT_GENDER
				TALENT:CHARA_ID:105 = -1
			ELSEIF LOCAL <= PERC_SETS:11:CURRENT_GENDER+PERC_SETS:12:CURRENT_GENDER+PERC_SETS:13:CURRENT_GENDER
				TALENT:CHARA_ID:105 = 0
			ELSEIF LOCAL <= PERC_SETS:11:CURRENT_GENDER+PERC_SETS:12:CURRENT_GENDER+PERC_SETS:13:CURRENT_GENDER+PERC_SETS:14:CURRENT_GENDER
				TALENT:CHARA_ID:105 = 1
			ELSEIF LOCAL <= PERC_SETS:11:CURRENT_GENDER+PERC_SETS:12:CURRENT_GENDER+PERC_SETS:13:CURRENT_GENDER+PERC_SETS:14:CURRENT_GENDER+PERC_SETS:15:CURRENT_GENDER
				TALENT:CHARA_ID:105 = 2
			ELSE
				TALENT:CHARA_ID:105 = CSVTALENT(CHARA_ID,105)
			ENDIF
			;CHILDLIKE
			LOCAL = RAND:100+1
			IF LOCAL <= PERC_SETS:16:CURRENT_GENDER
				TALENT:CHARA_ID:151 = 1
			ELSE
				TALENT:CHARA_ID:151 = CSVTALENT(CHARA_ID,151)
			ENDIF
			;DEFAULT_EARS EARS0 EARS1 EARS2 EARS3 EARS4
			IF PERC_SETS:17:CURRENT_GENDER == 0 || !CSVTALENT(CHARA_ID,143)
				LOCAL = RAND:100+1
				IF LOCAL <= PERC_SETS:18:CURRENT_GENDER
					TALENT:CHARA_ID:143 = 0
				ELSEIF LOCAL <= PERC_SETS:18:CURRENT_GENDER+PERC_SETS:19:CURRENT_GENDER
					TALENT:CHARA_ID:143 = 1
				ELSEIF LOCAL <= PERC_SETS:18:CURRENT_GENDER+PERC_SETS:19:CURRENT_GENDER+PERC_SETS:20:CURRENT_GENDER
					TALENT:CHARA_ID:143 = 2
				ELSEIF LOCAL <= PERC_SETS:18:CURRENT_GENDER+PERC_SETS:19:CURRENT_GENDER+PERC_SETS:20:CURRENT_GENDER+PERC_SETS:21:CURRENT_GENDER
					TALENT:CHARA_ID:143 = 3
				ELSEIF LOCAL <= PERC_SETS:18:CURRENT_GENDER+PERC_SETS:19:CURRENT_GENDER+PERC_SETS:20:CURRENT_GENDER+PERC_SETS:21:CURRENT_GENDER+PERC_SETS:22:CURRENT_GENDER
					TALENT:CHARA_ID:143 = 4
				ELSE
					TALENT:CHARA_ID:143 = CSVTALENT(CHARA_ID,143)
				ENDIF
			ENDIF
		NEXT
		PRINTFORMDW Randomizations applied to {LOCAL:3} \@ LOCAL:3 != 1 ? characters # character \@.
	CASE 1000
		RETURN
ENDSELECT
GOTO REPRINT

@EXCLUDE_CHARACTERS
#DIM EXCLUDED_CHARACTERS
#DIM CREDRAW
#DIM FIRST_LINE
FIRST_LINE = LINECOUNT
$REPRINT
CLEARLINE LINECOUNT - FIRST_LINE
CREDRAW = CURRENTREDRAW()
REDRAW 0
EXCLUDED_CHARACTERS = 0
PRINTL Characters in red will be excluded from randomization.
DRAWLINE
FOR LOCAL, 1, CHARANUM-1
	IF CFLAG:LOCAL:RANDOM_MENU_EXCLUSION
		SETCOLOR C_D_RED
		EXCLUDED_CHARACTERS++
	ENDIF
	PRINTFORMLC [{LOCAL}] %CALLNAME:LOCAL%
	RESETCOLOR
NEXT

PRINTL
DRAWLINE
PRINTL [995] - Save Settings　　   [996] - Load Settings	
PRINTL [997] - Invert Selection　　[998] - Reset
PRINTFORML [999] - Finish (Excluded: {EXCLUDED_CHARACTERS} \@ EXCLUDED_CHARACTERS != 1 ? characters # character \@)

INPUT
IF INRANGE(RESULT, 1, CHARANUM-1)
	CFLAG:RESULT:RANDOM_MENU_EXCLUSION = !CFLAG:RESULT:RANDOM_MENU_EXCLUSION
	GOTO REPRINT
ELSEIF RESULT == 995
	LOADGLOBAL
	PRINTL Save Exclusion Settings.
	PRINTFORML [0] Slot 0 \@STRLENS(RANDOM_SAVE_MENU_NAMES:3) > 0 ? - %RANDOM_SAVE_MENU_NAMES:3% # \@
	PRINTFORML [1] Slot 1 \@STRLENS(RANDOM_SAVE_MENU_NAMES:4) > 0 ? - %RANDOM_SAVE_MENU_NAMES:4% # \@
	PRINTFORML [2] Slot 2 \@STRLENS(RANDOM_SAVE_MENU_NAMES:5) > 0 ? - %RANDOM_SAVE_MENU_NAMES:5% # \@
	INPUT
	IF !INRANGE(RESULT, 0, 2)
		PRINTW Please keep within specified options.
		GOTO REPRINT
	ENDIF
	LOCAL = RESULT
	PRINTFORML Please name slot {LOCAL}, leave blank to cancel.
	INPUTS
	IF STRLENS(RESULTS) <= 0
		GOTO REPRINT
	ELSE
		CALL SAVE_EXCLUDE_CHARACTERS(RESULTS, LOCAL, 1)
		GOTO REPRINT
	ENDIF
ELSEIF RESULT == 996
	LOADGLOBAL
	PRINTL LOAD Exclusion Settings
	PRINTFORML [0] Slot 0 \@STRLENS(RANDOM_SAVE_MENU_NAMES:3) > 0 ? - %RANDOM_SAVE_MENU_NAMES:3% # \@
	PRINTFORML [1] Slot 1 \@STRLENS(RANDOM_SAVE_MENU_NAMES:4) > 0 ? - %RANDOM_SAVE_MENU_NAMES:4% # \@
	PRINTFORML [2] Slot 2 \@STRLENS(RANDOM_SAVE_MENU_NAMES:5) > 0 ? - %RANDOM_SAVE_MENU_NAMES:5% # \@
	INPUT
	IF !INRANGE(RESULT, 0, 2)
		PRINTW Please keep within specified options.
		GOTO REPRINT
	ELSE
		CALL LOAD_EXCLUDE_CHARACTERS(RESULT, 1)
		GOTO REPRINT
	ENDIF
ELSEIF RESULT == 997
	FOR LOCAL, 1, CHARANUM-1
		CFLAG:LOCAL:RANDOM_MENU_EXCLUSION = !CFLAG:LOCAL:RANDOM_MENU_EXCLUSION
	NEXT
	GOTO REPRINT
ELSEIF RESULT == 998
	FOR LOCAL, 1, CHARANUM-1
		CFLAG:LOCAL:RANDOM_MENU_EXCLUSION = 0
	NEXT
	GOTO REPRINT
ELSEIF RESULT == 999
	PRINTW Exclusions set up.
ENDIF

;Saves excluded character configuration
;ARG:0 - Which slot to save to
;ARG:1 - Which type, 0 is tied to percentage and thus doesn't have a name. 1 is independent.
@SAVE_EXCLUDE_CHARACTERS(ARGS, ARG, ARG:1=0)
#DIM SAVE_SLOT_NUMBER
#DIM SAVE_SLOT
LOADGLOBAL
SAVE_SLOT_NUMBER = ARG
IF ARG:1 == 0
	SAVE_SLOT = SAVE_SLOT_NUMBER
ELSEIF ARG:1 == 1
	SAVE_SLOT = SAVE_SLOT_NUMBER + 3
ENDIF
SIF ARG:1
	RANDOM_SAVE_MENU_NAMES:SAVE_SLOT = %ARGS%

FOR LOCAL, 1, CHARANUM-1
	RANDOM_MENU_EXCLUDE:SAVE_SLOT:LOCAL = CFLAG:LOCAL:RANDOM_MENU_EXCLUSION
NEXT
SAVEGLOBAL
IF ARG:1 == 1
	PRINTFORMW Slot {SAVE_SLOT_NUMBER} settings saved.
ENDIF

;Loads excluded character configuration
;ARG:0 - Which slot to load
;ARG:1 - Which type, 0 is tied to percentage and thus doesn't have a name. 1 is independent.
@LOAD_EXCLUDE_CHARACTERS(ARG, ARG:1=0)
#DIM LOAD_SLOT_NUMBER
#DIM LOAD_SLOT
LOADGLOBAL
LOAD_SLOT_NUMBER = ARG
IF ARG:1 == 0
	LOAD_SLOT = LOAD_SLOT_NUMBER
ELSEIF ARG:1 == 1
	LOAD_SLOT = LOAD_SLOT_NUMBER + 3
ENDIF

FOR LOCAL, 1, CHARANUM-1
	CFLAG:LOCAL:RANDOM_MENU_EXCLUSION = RANDOM_MENU_EXCLUDE:LOAD_SLOT:LOCAL
NEXT
IF ARG:1 == 1
	PRINTFORMW Slot {LOAD_SLOT_NUMBER} settings loaded.
ENDIF